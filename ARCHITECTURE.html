<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Design &amp; Architecture - The Standard Documentation</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="docs/theme/pagetoc.css">

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="index.html">Introduction</a></li><li class="chapter-item expanded affix "><a href="ARCHITECTURE.html" class="active">Design & Architecture</a></li><li class="chapter-item expanded affix "><a href="PITCH.html">Sales Pitch</a></li><li class="chapter-item expanded affix "><a href="COMPARE.html">Comparisions</a></li><li class="chapter-item expanded affix "><a href="ROADMAP.html">Roadmap</a></li><li class="chapter-item expanded affix "><li class="part-title">Tutorials</li><li class="chapter-item expanded "><a href="tutorials/walk-in-the-park.html"><strong aria-hidden="true">1.</strong> A walk in the park</a></li><li class="chapter-item expanded "><a href="tutorials/hello-world/index.html"><strong aria-hidden="true">2.</strong> Hello World</a></li><li class="chapter-item expanded "><a href="tutorials/hello-moon/index.html"><strong aria-hidden="true">3.</strong> Hello Moon</a></li><li class="chapter-item expanded affix "><li class="part-title">How-To Guides</li><li class="chapter-item expanded "><a href="guides/growing-cells.html"><strong aria-hidden="true">4.</strong> Growing Cells</a></li><li class="chapter-item expanded "><a href="guides/incl.html"><strong aria-hidden="true">5.</strong> Include Filter</a></li><li class="chapter-item expanded "><a href="guides/envrc.html"><strong aria-hidden="true">6.</strong> Setup .envrc</a></li><li class="chapter-item expanded affix "><li class="part-title">Explanation</li><li class="chapter-item expanded "><a href="explain/why-nix.html"><strong aria-hidden="true">7.</strong> Why nix?</a></li><li class="chapter-item expanded "><a href="explain/why-std.html"><strong aria-hidden="true">8.</strong> Why std?</a></li><li class="chapter-item expanded "><a href="explain/architecture-decision-records/index.html"><strong aria-hidden="true">9.</strong> Architecture Decisions</a></li><li class="chapter-item expanded affix "><li class="part-title">Patterns</li><li class="chapter-item expanded "><a href="patterns/four-packaging-layers.html"><strong aria-hidden="true">10.</strong> The 4 Packaging Layers</a></li><li class="chapter-item expanded "><a href="patterns/ci-cd-10000-feet.html"><strong aria-hidden="true">11.</strong> CI/CD â€” 10000ft flight height</a></li><li class="chapter-item expanded affix "><li class="part-title">Templates</li><li class="chapter-item expanded "><a href="templates/minimal.html"><strong aria-hidden="true">12.</strong> Minimal</a></li><li class="chapter-item expanded "><a href="templates/rust.html"><strong aria-hidden="true">13.</strong> Rust</a></li><li class="chapter-item expanded affix "><li class="part-title">Reference</li><li class="chapter-item expanded "><a href="reference/cli.html"><strong aria-hidden="true">14.</strong> TUI/CLI</a></li><li class="chapter-item expanded "><a href="reference/conventions.html"><strong aria-hidden="true">15.</strong> Conventions</a></li><li class="chapter-item expanded "><a href="reference/deprecations.html"><strong aria-hidden="true">16.</strong> Deprecations</a></li><li class="chapter-item expanded "><a href="reference/blocktypes.html"><strong aria-hidden="true">17.</strong> Builtin Block Types</a></li><li class="chapter-item expanded "><a href="reference/lib.html"><strong aria-hidden="true">18.</strong> Cell: lib</a></li><li class="chapter-item expanded "><a href="reference/std.html"><strong aria-hidden="true">19.</strong> Cell: std</a></li><li class="chapter-item expanded "><a href="glossary.html"><strong aria-hidden="true">20.</strong> Glossary</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Standard Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="standard-design-and-architecture"><a class="header" href="#standard-design-and-architecture">Standard Design and Architecture</a></h1>
<p>At the time of writing, almost a year of exploratory and freestyle project history has passed.
Fortunately, it is not necessary for further understanding, so I'll spare you that.
This document, though, lays out the design, architecture and direction of Standard.</p>
<p>If the topics discussed herein are dear to you, please take it as an invitation to get involved.</p>
<p>This design document shall be stable and amendments go through a proper process of consideration.</p>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>Standard is a collection of functionality and best practices (<em>&quot;framework&quot;</em>) to bootstrap and sustain the automatable sections of the Software Development Lifecycle (SDLC) <em>efficiently</em> with the power of Nix and Flakes.
In particular, Standard is a <em>Horizontal* Integration Framework</em> which integrates <em>vertical*</em> tooling.</p>
<blockquote>
<p><sub>We occasionally adapt concepts from non-technical contexts. This is one instance.</sub></p>
<p><em>Vertical Tooling</em> does one thing and does it well in a narrow scope (i.e &quot;vertical&quot;).</p>
<p><em>Horizontal Tooling</em> stitches vertical tooling together to a polished whole.</p>
</blockquote>
<p>What is being integrated are the end-to-end automatable sections of the SDLC.
For these we curate a collection of functionality, tools and best practices.</p>
<p>An SDLCs <em>efficiency</em> is characterized by two things.</p>
<p>Firstly, by adequate <em>lead time</em> which is the amount of time it takes to set up an initial version of the software delivery pipeline.
It needs to be <em>adequate</em> rather than <em>just fast</em>, as it takes place in the context of a team.
Rather than for speed, they need optimization for success.
For example, a process needs to be documented &amp; explained and your team needs to be trained on it.
Standard encourages incremental adoption in order to leave enough space for these paramount activities.
If you're in a hurry and your team is onboard, though, you still can jumpstart its adoption.</p>
<p>Secondly, efficient SDLCs are characterized by short <em>cycle times</em> which is the amount of time it takes for a designed feature to be shipped to production.
Along this journey, we encounter our scope (more on it below):</p>
<ul>
<li>aspects of the <em>development</em> environment;</li>
<li>the packaging pipeline that produces artifacts;</li>
<li>and continuous processes integrating the application lifecycle.</li>
</ul>
<p>Hence, the goal of Standard is to:</p>
<ul>
<li>Enable easy and incremental adoption</li>
<li>Optimize the critical path that reduces your SDLC's cycle time.</li>
</ul>
<p>Additionally, unlike similar projects, we harness the power of Nix &amp; Flakes to ensure reproducibility.</p>
<h2 id="goals"><a class="header" href="#goals">Goals</a></h2>
<ul>
<li><em>Complete</em>: Standard should cover the important use cases for setting up and running the automatable sections of the SDLC.</li>
<li><em>Optimized</em>: Standard should optimize both for the needs of the individual developers and the market success of the product.</li>
<li><em>Integrated</em>: Standard should provide the user with a satisfying integration experience across a well-curated assortment of tools and functionality.</li>
<li><em>Extensible</em>: Standard should account for the need to seamlessly modify, swap or extend its functionality when necessary.</li>
</ul>
<p>Please defer to the <a href="./PITCH.html">sales pitch</a>, if you need more context.</p>
<h2 id="ideals"><a class="header" href="#ideals">Ideals</a></h2>
<p>While we aim to improve the SDLC by applying Nix and its ecoysystem's ingenuity to the problem, we also want to build bridges.
In order to bring the powers of store based reproducible packaging to colleagues and friends, we need to maneuver around the ecosystem's pitfalls:</p>
<ul>
<li><em>Use nix only where it is best suited</em> â€” a Nix maximalist approach may be an innate condition to some of us, but to build bridges we deeply recognize and value other perspectives and don't dismiss them as ignorance.</li>
<li><em>Disrupt where disruption is necessary</em> â€” the Nix ecosystem has a fairly rigid set of principles and norms that we don't think always apply in every use case.</li>
<li><em>Look left, right, above and beyond</em> â€” our end-to-end perspective commands us to actively seek and reach out to other projects and ecosystems to compose our value chain; there's no place for the &quot;not invented here&quot;-syndrome.</li>
</ul>
<h2 id="scope"><a class="header" href="#scope">Scope</a></h2>
<p>These are big goals and ideals.
In the interest of practical advancements, we'll narrow down the scope in this section.</p>
<p>We can subdivide (not break up!) our process into roughly three regions with different shapes and characteristics:</p>
<ul>
<li><strong>Development Environment</strong> roughly covers <em>code-to-commit</em>.</li>
<li><strong>Packaging Pipeline</strong> roughly covers <em>commit-to-distribution</em>.</li>
<li><strong>Deployment and Beyond</strong> roughly covers <em>distribution-to-next-rollout</em>.</li>
</ul>
<p>We delegate:</p>
<ul>
<li>The <strong>Development Environment</strong> to a trusted project in the broader Nix Community employing community outreach to promote our cause and ensure it is at least not accidentally sabotaged.</li>
<li>The <strong>Deployment and Beyond</strong> by cultivating outreach and dovetailing with initiatives of, among others, the Cloud Native ecosystem.</li>
</ul>
<p>And we focus on:</p>
<ul>
<li>The <strong>Packaging Pipeline</strong></li>
<li><em>Interfaces</em> and <em>Integration</em> with the other two</li>
</ul>
<h2 id="architecture"><a class="header" href="#architecture">Architecture</a></h2>
<p>With clarity about Standard's general scope and direction, let's procede to get an overview over its architecture.</p>
<h3 id="locating-standard-in-the-sdlc"><a class="header" href="#locating-standard-in-the-sdlc">Locating Standard in the SDLC</a></h3>
<p>Where is Standard located in the big picture?</p>
<p>This graphic locates Standard across the SDLC &amp; Application Lifecycle Management (ALM).</p>
<p>But not only that.
It also explains how automation in itself is implemented as <em>code</em>, just as the application itself.
Therefore, we make a distinction between:</p>
<ul>
<li>first order application code (L1); and</li>
<li>above that, higher order supporting code as exemplified by L2 and L3.</li>
</ul>
<blockquote>
<p>Glossary:</p>
<p><em>L2 &amp; L3</em> have no clearly defined meaning.
They represent that we may observe multiple layers of higher order code when automating.
Examples could be bash scripts, configuration data, platform utility code and more.</p>
</blockquote>
<div align="center"><img src="./artwork/sdlc.svg" width="900" /></div>
<h3 id="standards-components-and-their-value-contribution"><a class="header" href="#standards-components-and-their-value-contribution">Standard's Components and their Value Contribution</a></h3>
<p>What is Standard made of? And how do its components contribute value?</p>
<p>On the left side of the graphic, we show how Standard, like an onion, is build in layers:</p>
<p>Center to Standard is <a href="https://github.com/divnix/paisano"><code>divnix/paisano</code></a>.
This flake (i.e. &quot;Nix library&quot;) implements two main abstractions: Block Types and Cells.</p>
<p><em><strong>Block Types</strong></em> are not unlike Rust's traits or Golang's interfaces.
They are abstract definitions of artifact classes.
Those abstract classes implement <em>shared functionality</em>.</p>
<p>A few examples of artifact classes in our scope are: packages, containers, scripts and manifests, among others.
Examples of shared functionality are (a shared implementation of) <em>push</em> on containers and (a shared implementation of) <em>build</em> on packages.</p>
<p><em><strong>Cells</strong></em>, in turn, organize your code into related units of functionality.
Hence, Cells are a code <em>orgnization principle</em>.</p>
<p>On top of Paisano's abstractions, Standard implements within its scope:</p>
<ul>
<li>a collection of Block Types; and</li>
<li>a collection of library functionality organized in Cells.</li>
</ul>
<p>On the right side of the graphic, we sketch an idea of how these components are put into service for the SDLC.</p>
<div align="center"><img src="./artwork/components.svg" width="900" /></div>
<h3 id="paisano-code-organization"><a class="header" href="#paisano-code-organization">Paisano (Code Organization)</a></h3>
<p>We already learned about Paisano's two main abstractions: Cells &amp; Block Types.</p>
<p>Cells enable and encourage the user to cleanly organize their code into related units of functionality.
The concrete semantics of code layout are completely at her choosing.
For example, she could separate application tiers like frontend and backend into their own cells, each.
Or she could reflect the microservices architecture in the Cells.</p>
<p>Paisano has a first class concept of Cells.
By simply placing a folder in the repository, Paisano will pick it up.
In that regard, Paisano is an automated importer, that spares the user the need to setup and maintain boilerplate plumbing code.</p>
<p>Within a Cell, the user groups artifacts within Blocks of an appropriate Block Type.
When configuring Standard, she names her Blocks using Standard's Block Types so that Paisano's importer can pick them up, too.
By doing that, she also declares the repository's artifact type system to humans and machines.</p>
<p>Machines can make great use of that to interact with the artifact type system in multiple ways.
Paisano exports structured json-serializable data about a repository's <em>typed</em> artifacts in its so-called &quot;Paisano Registry&quot;.
A CLI or TUI, as is bundled with Standard, or even a web user interface can consume, represent and act upon that data.</p>
<p>And so can CI.</p>
<p>In fact, this is an innovation in the SDLC space:
We can devise an implementation of a CI which, by querying Paisano's Registry, autonomously discovers all work that needs to be done.
In order to demonstrate the value of this proposition, we made a reference implementation for GitHub Actions over at <a href="https://github.com/divnix/paisano"><code>divnix/std-action</code></a>.
To our knowledge, this is the first and only &quot;zero config&quot; CI implementation based on the principles of artifact typing and code organization.
By using these principles rather than a rigid opinionated structure, it also remains highly flexible and adapts well to the user's preferences &amp; needs.</p>
<p>In summary, all these organization and typing principles enable:</p>
<ul>
<li>easy refactoring of your repository's devops namespace;</li>
<li>intuitive grouping of functionality that encourages well-defined internal boundaries,
<ul>
<li>allowing for keeping your automation code clean and maintainable;</li>
</ul>
</li>
<li>making use of Block Types and the shared library to implement the DRY principle;</li>
<li>reasoning about the content of your repo through structured data,
<ul>
<li>and, thereby, facilitate interesting user interfaces, such as a CLI, TUI or even a UI,</li>
<li>as well as services like a (close to) zero config, self-updating CI;</li>
</ul>
</li>
<li>similar organizational principles help to lower the cost of context switching between different projects.</li>
</ul>
<h3 id="standards-block-types-devops-type-system"><a class="header" href="#standards-block-types-devops-type-system">Standard's Block Types (DevOps Type System)</a></h3>
<p>As mentioned above, Standard exploits the Block Type abstraction to provide artifact types for the SDLC.
Within the semantics of each Block Type, we implement shared functionality.
This is designed to offer the user an optimized, audited implementation.
Alleviates the burden of devising &quot;yet another&quot; local implementation of otherwise well-understood generic functionality, such as, the building of a package or the pushing of a container image.</p>
<h3 id="standards-cells-function-library"><a class="header" href="#standards-cells-function-library">Standard's Cells (Function Library)</a></h3>
<p>Alongside the <strong>Packaging Pipeline</strong>, Standard provides a curated assortment of library functions and integrations that users can adopt.
While optional, an audited and community maintained function library and its corresponding documentation fulfills the promise of productivity, shared mental models and ease of adoption.</p>
<h2 id="modularity--virality-model"><a class="header" href="#modularity--virality-model">Modularity &amp; Virality Model</a></h2>
<p>We aim to provide a public registry in which we index and aggregate additional Block Types and Cells from the Standard user community that are not maintained in-tree.
To boost its value, aggregate documentation will be part of that registry.
We need to decide on how to deeply integrate documentation concerns, such as structured docstrings &amp; adjacent readmes, into the framework.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="PITCH.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="PITCH.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="docs/theme/pagetoc.js"></script>


    </div>
    </body>
</html>
